(function(d,p){typeof exports=="object"&&typeof module<"u"?p(exports):typeof define=="function"&&define.amd?define(["exports"],p):(d=typeof globalThis<"u"?globalThis:d||self,p(d.Gofakeit={}))})(this,(function(d){"use strict";const p="https://api.gofakeit.com/funcs";async function M(c,e){const{func:t,params:n}=k(c),r={...n,...e||{}};try{return{result:await S("POST",`${p}/${t}`,r)}}catch(a){return{error:a instanceof Error?a.message:"Unknown error"}}}async function v(c){if(c.length===0)return{error:"No functions provided"};try{const e=c.map((n,r)=>{const{func:a,id:s,params:o}=n,{func:i,params:u}=k(a),h={...u,...o||{}};return{id:s||`req_${r}`,func:i,params:h}});return{results:await S("POST",`${p}/multi`,e)}}catch(e){return{error:e instanceof Error?e.message:"Unknown error"}}}async function T(c){const e=Array.isArray(c)?c:[c];if(e.length===0)return{error:"No search requests provided"};try{const t=await S("POST",`${p}/search`,e);return Array.isArray(c)?{results:t}:{results:t[0]}}catch(t){return{error:t instanceof Error?t.message:"Unknown error"}}}async function S(c,e,t){try{const n={method:c,headers:{"Content-Type":"application/json"}};c==="POST"&&t&&(n.body=JSON.stringify(t));const r=await fetch(e,n);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return e.includes("/multi")||e.includes("/search")?await r.json():await r.text()}catch(n){throw new Error(n instanceof Error?n.message:"Unknown error")}}function k(c){const e=c.indexOf("?");if(e!==-1){const t=c.substring(0,e),n=c.substring(e+1),r={},a=new URLSearchParams(n);for(const[s,o]of a.entries()){const i=parseFloat(o);r[s]=isNaN(i)?o:i}return{func:t,params:r}}else return{func:c,params:{}}}const w={primary:"#ffa000",white:"#ffffff",error:"#ff3860",text:"#333333"},x={half:8,quarter:4},C={radius:4},A={size:12,family:"Helvetica, Arial, sans-serif"};var L=(c=>(c.STARTING="starting",c.FOUND="found",c.DETERMINED="determined",c.GENERATED="generated",c.SET="set",c.COMPLETED="completed",c.ERROR="error",c))(L||{});class F{settings;state;constructor(e={}){this.settings={mode:"auto",stagger:50,badges:3e3,debug:!1,...e},this.state={elements:[]}}updateSettings(e){this.settings={...this.settings,...e}}async fill(e,t,n){return this.state.elements=[],this.updateStatus("starting"),this.setElements(e),this.state.elements.length===0?(this.debug("info","No form fields found to fill"),this.updateStatus("completed"),this.results()):(this.updateStatus("found"),await this.setElementFunctions(t,n),this.updateStatus("determined"),await this.getElementValues(),this.updateStatus("generated"),await this.setElementValues(),this.updateStatus("set"),this.updateStatus("completed"),this.results())}setElements(e){const t=[];if(e){if(typeof e=="string"){const s=document.querySelectorAll(e);if(s.length===0){this.debug("error",`No element found with selector: "${e}"`),this.updateStatus("error"),this.state.elements=[];return}s.forEach(o=>{if(o instanceof HTMLInputElement||o instanceof HTMLTextAreaElement||o instanceof HTMLSelectElement){if(this.shouldSkipElement(o))return;t.push(o)}else o.querySelectorAll("input, textarea, select").forEach(h=>{this.shouldSkipElement(h)||t.push(h)})})}else if(e instanceof HTMLElement||e instanceof Element)if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement){if(this.shouldSkipElement(e)){this.state.elements=[];return}t.push(e)}else e.querySelectorAll("input, textarea, select").forEach(i=>{this.shouldSkipElement(i)||t.push(i)})}else document.querySelectorAll("input, textarea, select").forEach(i=>{this.shouldSkipElement(i)||t.push(i)});const n=this.settings.mode??"auto",r=[];for(const s of t){const o=s.getAttribute("data-gofakeit");typeof o=="string"&&o.trim().toLowerCase()==="false"||n==="manual"&&!o||r.push(s)}const a=[];for(const s of r){const o=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);a.push({id:o,name:s.getAttribute("name")||"",element:s,type:this.getElementType(s),function:"",search:this.getElementSearch(s),value:"",error:""})}this.state.elements=a,a.length>0&&this.debug("info",`Found ${a.length} elements to generate data for`)}shouldSkipElement(e){return e instanceof HTMLInputElement?e.type==="hidden"||e.disabled||e.readOnly:e instanceof HTMLTextAreaElement?e.disabled||e.readOnly:e instanceof HTMLSelectElement?e.disabled:!1}getElementType(e){return e instanceof HTMLInputElement?e.type.toLowerCase():e instanceof HTMLTextAreaElement?"textarea":e instanceof HTMLSelectElement?"select":"unknown"}getElementSearch(e){const t=[],n=[],r=e.id,a=e.getAttribute("aria-labelledby");if(a&&a.split(/\s+/).forEach(l=>{const f=document.getElementById(l);f&&f.textContent&&n.push(f.textContent)}),r){const l=document.querySelector('label[for="'+r.replace(/"/g,'\\"')+'"]');l&&l.textContent&&n.push(l.textContent)}const s=e.closest("label");s&&s.textContent&&n.push(s.textContent);const o=e.previousElementSibling;o&&o.tagName==="LABEL"&&o.textContent&&n.push(o.textContent),n.forEach(l=>{l&&l.trim()&&t.push(l.trim().toLowerCase())});const i=e instanceof HTMLInputElement?e.type.toLowerCase():"";i&&i.trim()&&t.push(i);const u=e.getAttribute("name")||"";u&&u.trim()&&t.push(u.toLowerCase());const h=e.id||"";h&&h.trim()&&t.push(h.toLowerCase());const g=e instanceof HTMLInputElement&&e.placeholder||"";g&&g.trim()&&t.push(g.toLowerCase());const E=e instanceof HTMLInputElement&&e.autocomplete||"";E&&E.trim()&&t.push(E.toLowerCase());const b=e.getAttribute("aria-label")||"";return b&&b.trim()&&t.push(b.toLowerCase()),t.filter(l=>l&&l.trim())}async setElementFunctions(e,t){if(this.debug("info",`Determining functions for ${this.state.elements.length} elements`),e){this.debug("info",`Using function override: ${e}`);for(const r of this.state.elements)r.function=e,t&&(r.params=t);return}const n=[];for(const r of this.state.elements){const a=this.getElementFunction(r.element);a!==null?r.function=a:n.push(r)}if(n.length>0){this.debug("info",`${n.length} elements need function search`);const r=n.map((s,o)=>({id:s.element.id||s.element.getAttribute("name")||`input_${o}`,queries:s.search})),a=await T(r);if(a.results&&!a.error){const s=Array.isArray(a.results)?a.results:[a.results];for(let o=0;o<s.length&&o<n.length;o++){const i=s[o],u=n[o];i.results&&i.results.length>0?u.function=i.results[0].name:u.function=this.getElementFunctionFallback(u.element)}for(let o=s.length;o<n.length;o++)n[o].function=this.getElementFunctionFallback(n[o].element)}else for(const s of n)s.function=this.getElementFunctionFallback(s.element)}this.debug("info","Function determination complete")}getElementFunction(e){const t=e.getAttribute("data-gofakeit"),n=this.getElementType(e);return t&&t!=="true"?t:t==="true"?this.elementTypeNeedsSearch(n)?null:this.getElementFunctionFallback(e):this.elementTypeNeedsSearch(n)?null:this.getElementFunctionFallback(e)}elementTypeNeedsSearch(e){return!["checkbox","radio","select","range","file","button","submit","reset","image","week","date","time","datetime-local","month","color"].includes(e)}getElementFunctionFallback(e){if(e instanceof HTMLInputElement)switch(e.type.toLowerCase()){case"date":case"datetime-local":case"month":case"week":{const n=e.getAttribute("min"),r=e.getAttribute("max");return n||r?"daterange":"date"}case"time":return"time";case"text":return"word";case"email":return"email";case"tel":return"phone";case"url":return"url";case"password":return"password";case"search":return"word";case"number":case"range":{const n=e.getAttribute("min"),r=e.getAttribute("max");return"number"}case"color":return"hexcolor";case"checkbox":return"bool";case"radio":return"randomstring";default:return"word"}else{if(e instanceof HTMLTextAreaElement)return"sentence";if(e instanceof HTMLSelectElement)return"randomstring"}return"word"}async getElementValues(){this.debug("info","Starting value generation...");const e=this.state.elements.filter(s=>s.function&&!s.error);if(e.length===0){this.debug("info","No elements need value generation");return}this.debug("info",`Getting values for ${e.length} elements from API`);const t=[],n=[],r=[];for(const s of e){if(s.type==="radio"&&s.name&&n.includes(s.name))continue;const o={id:s.id,func:s.function};if(s.params)o.params=s.params;else switch(s.type){case"select":o.params=this.paramsSelect(s.element);break;case"radio":{const i=e.filter(u=>u.type==="radio"&&u.name===s.name);o.params=this.paramsRadio(i),s.name&&n.push(s.name);break}case"date":case"datetime-local":case"month":{const i=this.paramsDate(s);i&&(i.startdate||i.enddate)&&(o.func="daterange"),o.params=i;break}case"time":{o.params={format:"HH:mm"};break}case"week":{const i=this.paramsWeek(s);i&&(i.startdate||i.enddate)?(o.func="daterange",o.params=i):(o.func="date",o.params=i);break}case"number":case"range":{const i=this.paramsNumber(s);o.params=i;break}}t.push(o),r.push(s)}const a=await v(t);if(a.results&&!a.error)for(let s=0;s<a.results.length;s++){const o=a.results[s],i=r[s];o.value!==null&&o.value!==void 0?i.value=String(o.value):o.error?i.error=o.error:i.error="Unknown API error"}else for(const s of e)s.error=a.error||"API request failed";this.debug("info","Value generation complete")}async setElementValues(){if(this.debug("info","Starting value application..."),this.state.elements.length===0){this.debug("info","No elements to apply values to");return}this.debug("info",`Processing ${this.state.elements.length} elements`);const e=[];for(let t=0;t<this.state.elements.length;t++){const n=this.state.elements[t];let r=null;switch(n.type){case"radio":n.name&&!e.includes(n.name)&&(e.push(n.name),r=this.setRadioGroup(n));break;default:n.value!==void 0&&n.value!==null&&!n.error&&this.setElementValue(n),r=n;break}this.settings.badges&&this.settings.badges>0&&r&&this.showBadge(r),this.settings.stagger&&this.settings.stagger>0&&t<this.state.elements.length-1&&await new Promise(a=>setTimeout(a,this.settings.stagger))}this.debug("info","Value application complete")}setRadioGroup(e){const n=this.state.elements.filter(r=>r.type==="radio"&&r.name===e.name).find(r=>{const a=r.element;if((a.hasAttribute("value")||a.value!=="on")&&a.value===e.value)return!0;const o=document.querySelector(`label[for="${a.id}"]`);return!!(o&&o.textContent&&o.textContent.trim()===e.value||a.id===e.value)});if(n&&!n.error){const r=n.element.name;return r&&document.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach(s=>{s.checked=!1}),n.element.checked=!0,n.element.dispatchEvent(new Event("change",{bubbles:!0})),n}else if(e.error)return e;return null}setElementValue(e){const t=e.element;if(t instanceof HTMLInputElement)switch(t.type.toLowerCase()){case"checkbox":this.setCheckboxValue(t,e.value);break;case"radio":this.setRadioValue(t,e.value);break;case"number":case"range":case"date":case"time":case"datetime-local":case"month":case"color":this.setGeneralValue(t,e.value);break;case"week":this.setGeneralValue(t,this.convertDateToWeek(e.value));break;default:this.setGeneralValue(t,e.value)}else t instanceof HTMLTextAreaElement?this.setGeneralValue(t,e.value):t instanceof HTMLSelectElement&&this.setSelectValue(t,e.value)}setGeneralValue(e,t){e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0}))}setCheckboxValue(e,t){const n=t==="true"||t===!0;e.checked=n,e.dispatchEvent(new Event("change",{bubbles:!0}))}setRadioValue(e,t){if(t==="true"||t===!0){const r=e.name;r&&document.querySelectorAll(`input[type="radio"][name="${r}"]`).forEach(s=>{s!==e&&(s.checked=!1)}),e.checked=!0,e.dispatchEvent(new Event("change",{bubbles:!0}))}else e.checked=!1,e.dispatchEvent(new Event("change",{bubbles:!0}))}setSelectValue(e,t){if(Array.from(e.options).find(s=>s.value===t)){e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0}));return}const r=Array.from(e.options).find(s=>s.textContent?.toLowerCase().includes(t.toLowerCase()));if(r){e.value=r.value,e.dispatchEvent(new Event("change",{bubbles:!0}));return}const a=Array.from(e.options).filter(s=>s.value&&s.value.trim()!=="");if(a.length>0){const s=a[Math.floor(Math.random()*a.length)];e.value=s.value,e.dispatchEvent(new Event("change",{bubbles:!0}))}}showBadge(e){this.removeBadge(e.id);const t=document.createElement("div");t.id=`gofakeit-badge-${e.id}`;const n=!!(e.error&&e.error.trim()!=="");t.textContent=n?e.error:e.function;const r={position:"fixed",zIndex:"999999",padding:`${x.quarter}px ${x.half}px`,borderRadius:`${C.radius}px`,fontSize:`${A.size}px`,fontWeight:"bold",fontFamily:A.family,boxShadow:"0 2px 4px rgba(0,0,0,0.2)",pointerEvents:"none",userSelect:"none",transition:"opacity 0.3s ease-in-out",opacity:"0",whiteSpace:"nowrap",backgroundColor:n?w.error:w.primary,color:n?w.white:w.text};Object.assign(t.style,r),document.body.appendChild(t);let a=null,s=null,o=!0,i=0;const u=100,h=this.getScrollableParents(e.element),g=new Map,E=l=>{const f=l.getBoundingClientRect();if(f.top<0||f.left<0||f.bottom>window.innerHeight||f.right>window.innerWidth)return!1;for(const y of h){let m=g.get(y);if(m||(m=y.getBoundingClientRect(),g.set(y,m)),f.top<m.top||f.left<m.left||f.bottom>m.bottom||f.right>m.right)return!1}return!0},b=()=>{const l=e.element.getBoundingClientRect();if(!a||l.top!==a.top||l.left!==a.left||l.width!==a.width||l.height!==a.height){a=l;const y=performance.now();if(y-i>u&&(o=E(e.element),i=y,g.clear()),o){const m=l.top-30,$=l.left;t.style.cssText+=`top:${m}px;left:${$}px;display:block;`}else t.style.display="none"}s=requestAnimationFrame(b)};b(),t._animationId=s,requestAnimationFrame(()=>{t.style.opacity="1"}),setTimeout(()=>{this.removeBadge(e.id)},this.settings.badges)}getScrollableParents(e){const t=[];let n=e.parentElement;for(;n&&n!==document.body;){const r=getComputedStyle(n),a=r.overflow+r.overflowY+r.overflowX;(a.includes("scroll")||a.includes("auto"))&&t.push(n),n=n.parentElement}return t}removeBadge(e){const t=document.getElementById(`gofakeit-badge-${e}`);if(!t)return;const n=t._animationId;n&&(cancelAnimationFrame(n),t._animationId=null),t.style.opacity="0",setTimeout(()=>{t.parentNode&&t.remove()},300)}paramsSelect(e){const t=Array.from(e.options).map(n=>n.value).filter(n=>n!=="");if(t.length>0)return{strs:t}}paramsRadio(e){const t=e.map(n=>{const r=n.element;if(r.hasAttribute("value")||r.value&&r.value.trim()!==""&&r.value!=="on")return r.value;const s=document.querySelector(`label[for="${r.id}"]`);return s&&s.textContent?s.textContent.trim():r.id}).filter(n=>n!=="");if(t.length>0)return{strs:t}}convertDateToWeek(e){try{const t=new Date(e+"T00:00:00"),n=t.getFullYear(),r=new Date(n,0,1),a=Math.floor((t.getTime()-r.getTime())/(1440*60*1e3)),s=Math.ceil((a+r.getDay()+1)/7);return`${n}-W${s.toString().padStart(2,"0")}`}catch{return`${new Date().getFullYear()}-W01`}}convertWeekToDate(e){try{const t=e.match(/^(\d{4})-W(\d{2})$/);if(!t)throw new Error("Invalid week format");const n=parseInt(t[1]),r=parseInt(t[2]),a=new Date(n,0,1),s=(r-1)*7,o=new Date(a.getTime()+s*24*60*60*1e3),i=(o.getMonth()+1).toString().padStart(2,"0"),u=o.getDate().toString().padStart(2,"0");return`${n}-${i}-${u}`}catch{return`${new Date().getFullYear()}-01-01`}}paramsDate(e){const t=e.element,n=t.getAttribute("min"),r=t.getAttribute("max");let a;switch(e.type){case"datetime-local":a="yyyy-MM-ddTHH:mm";break;case"month":a="yyyy-MM";break;case"date":default:a="yyyy-MM-dd";break}const s={format:a};return!n&&!r||(n&&(s.startdate=n),r&&(s.enddate=r)),s}paramsWeek(e){const t=e.element,n=t.getAttribute("min"),r=t.getAttribute("max"),a={format:"yyyy-MM-dd"};return n&&(a.startdate=this.convertWeekToDate(n)),r&&(a.enddate=this.convertWeekToDate(r)),a}paramsNumber(e){const t=e.element,n=t.getAttribute("min"),r=t.getAttribute("max"),a={};return n&&(a.min=parseInt(n,10)),r&&(a.max=parseInt(r,10)),a}debug(e,t){if(this.settings.debug){const n=`[Gofakeit] ${e.toUpperCase()}:`;switch(e){case"error":console.error(n,t);break;case"warning":console.warn(n,t);break;case"info":default:console.log(n,t);break}}}resetState(){this.state={elements:[]}}updateStatus(e){if(this.state.status=e,this.settings.onStatusChange){const t=[...this.state.elements];this.settings.onStatusChange(e,t)}}results(){const e=this.state.elements.filter(r=>r.value&&!r.error),t=this.state.elements.filter(r=>r.error),n={success:e.length,failed:t.length,elements:this.state.elements};return this.debug("info",`
ðŸŽ¯ Autofill Results Summary:`),this.debug("info",`   Total elements: ${this.state.elements.length}`),this.debug("info",`   Successful: ${e.length}`),this.debug("info",`   Failed: ${t.length}`),e.length>0&&t.length===0?this.debug("warning",`Successfully generated data for ${e.length} fields!`):e.length>0&&t.length>0?this.debug("warning",`Generated data for ${e.length} fields, ${t.length} failed`):t.length>0?this.debug("error",`Failed to generate data for ${t.length} fields`):this.debug("warning","No fields were processed"),n}}d.Autofill=F,d.AutofillStatus=L,d.fetchFunc=M,d.fetchFuncMulti=v,d.fetchFuncSearch=T,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})}));
//# sourceMappingURL=gofakeit.umd.js.map
